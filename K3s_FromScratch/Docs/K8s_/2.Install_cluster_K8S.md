ğŸ“˜ Cours Kubernetes â€” Chapitre 2

ğŸ—ï¸ Installation dâ€™un cluster Kubernetes (environnement rÃ©el)

---

ğŸ¯ Objectif du chapitre

Ã€ la fin de ce chapitre, tu sauras :

Comprendre les prÃ©requis dâ€™un cluster Kubernetes

Installer un cluster Kubernetes standard avec kubeadm

Comprendre chaque composant installÃ©

VÃ©rifier que le cluster est opÃ©rationnel

---

ğŸ–¥ï¸ 1. Architecture cible du cluster

Un cluster Kubernetes se compose de :

RÃ´le Description

ğŸ§  Control Plane GÃ¨re et orchestre le cluster
âš™ï¸ Workers ExÃ©cutent les applications

---

ğŸ”§ 2. PrÃ©requis systÃ¨me

ğŸ“¦ MatÃ©riel minimum par nÅ“ud

Ressource Minimum recommandÃ©

CPU 2 vCPU
RAM 2 Go (4 Go recommandÃ©)
Disque 20 Go
OS Linux 64-bit (Ubuntu, Debian, RHELâ€¦)

---

ğŸŒ RÃ©seau

Tous les nÅ“uds doivent pouvoir communiquer :

Port Usage

6443 API Server
2379â€“2380 etcd
10250 kubelet
10259 scheduler
10257 controller-manager

---

âš™ï¸ 3. Installer les dÃ©pendances (sur TOUS les nÅ“uds)

sudo apt update
sudo apt install -y apt-transport-https ca-certificates curl

---

ğŸ³ Installer le runtime de conteneurs (containerd)

sudo apt install -y containerd
sudo systemctl enable containerd
sudo systemctl start containerd

---

â˜¸ï¸ 4. Installer Kubernetes (kubeadm, kubelet, kubectl)

sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg \
https://packages.cloud.google.com/apt/doc/apt-key.gpg

echo "deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] \
https://apt.kubernetes.io/ kubernetes-xenial main" | \
sudo tee /etc/apt/sources.list.d/kubernetes.list

sudo apt update
sudo apt install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl

---

ğŸ§  5. Initialiser le Control Plane

Sur le nÅ“ud Control Plane uniquement :

sudo kubeadm init --pod-network-cidr=10.244.0.0/16

Cette commande :

Installe lâ€™API Server

Installe etcd

Lance le scheduler et les contrÃ´leurs

---

ğŸ“ Configurer kubectl pour lâ€™utilisateur

mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config

Tester :

kubectl get nodes

---

ğŸŒ 6. Installer le rÃ©seau Pod (CNI)

Kubernetes nÃ©cessite un plugin rÃ©seau.

Exemple avec Flannel :

kubectl apply -f https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml

---

âš™ï¸ 7. Ajouter un Worker au cluster

Sur le Control Plane, rÃ©cupÃ©rer la commande join :

kubeadm token create --print-join-command

Sur le Worker :

sudo kubeadm join <IP_CONTROL_PLANE>:6443 --token <TOKEN> \
--discovery-token-ca-cert-hash sha256:<HASH>

---

ğŸ§ª 8. VÃ©rification du cluster

kubectl get nodes
kubectl get pods -A

Tu dois voir :

coredns

kube-proxy

contrÃ´leurs systÃ¨me

---

ğŸ“Œ RÃ©sumÃ© du chapitre

Ã‰tape Action

Installer runtime containerd
Installer outils kubeadm, kubelet, kubectl
Initialiser cluster kubeadm init
Installer rÃ©seau CNI
Ajouter workers kubeadm join

---

ğŸ“ Ã€ retenir

> kubeadm installe un cluster Kubernetes conforme aux standards officiels, prÃªt pour un environnement rÃ©el.

---

ğŸ”œ Chapitre suivant

ğŸ“¦ DÃ©ploiement des premiers Pods
ğŸ§© Comprendre les objets Kubernetes fondamentaux
