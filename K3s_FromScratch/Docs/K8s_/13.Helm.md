ğŸ“˜ Cours Kubernetes (Upstream) â€” Chapitre 13

ğŸ“¦ Helm : packaging, templating et gestion des versions applicatives


---

ğŸ¯ Objectifs pÃ©dagogiques

Ã€ la fin de ce chapitre, tu comprendras :

Pourquoi Helm est indispensable en production Kubernetes

Ce quâ€™est un Chart Helm

Comment Helm rÃ©sout les limites du YAML â€œbrutâ€

Comment versionner, dÃ©ployer, mettre Ã  jour et rollback une application



---

ğŸ§  1. Le problÃ¨me des manifests YAML â€œÃ  la mainâ€

Sans Helm, une application Kubernetes nÃ©cessite :

plusieurs fichiers YAML

des valeurs dupliquÃ©es

des diffÃ©rences par environnement (dev/staging/prod)

des mises Ã  jour difficiles Ã  tracer


Exemple de problÃ¨mes :

changer une image â†’ modifier plusieurs fichiers

changer un hostname â†’ copier/coller risquÃ©

rollback manuel complexe


ğŸ‘‰ Helm apporte une couche dâ€™abstraction et de standardisation.


---

â˜¸ï¸ 2. Quâ€™est-ce que Helm ?

Helm est le gestionnaire de packages de Kubernetes.

> Helm = apt / yum de Kubernetes



Il permet de :

packager une application

dÃ©finir des valeurs paramÃ©trables

gÃ©rer des versions

installer / upgrader / rollback


Documentation officielle :
https://helm.sh/docs/


---

ğŸ“¦ 3. Le Chart Helm

Un Chart est un package Helm.

Structure standard :

my-chart/
â”œâ”€â”€ Chart.yaml
â”œâ”€â”€ values.yaml
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â””â”€â”€ ingress.yaml


---

ğŸ“„ Chart.yaml

apiVersion: v2
name: my-app
description: Application web Kubernetes
type: application
version: 1.0.0
appVersion: "1.0"

version â†’ version du chart

appVersion â†’ version de lâ€™application



---

âš™ï¸ values.yaml

replicaCount: 2

image:
  repository: nginx
  tag: "1.25"

service:
  port: 80

ingress:
  enabled: true
  host: app.example.com

ğŸ‘‰ Toutes les variables sont centralisÃ©es ici


---

ğŸ§© 4. Templates Helm

Les fichiers dans templates/ sont des YAML paramÃ©trables.

Extrait deployment.yaml :

spec:
  replicas: {{ .Values.replicaCount }}
  template:
    spec:
      containers:
      - image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"

Helm gÃ©nÃ¨re les YAML finaux avant de les appliquer Ã  Kubernetes.


---

ğŸš€ 5. DÃ©ployer une application avec Helm

helm install my-release ./my-chart

VÃ©rifier :

helm list
kubectl get pods


---

ğŸ” 6. Mettre Ã  jour une application

Changer une valeur :

helm upgrade my-release ./my-chart \
  --set image.tag=1.26

Helm applique un rolling update Kubernetes.


---

âª 7. Rollback

Lister les versions :

helm history my-release

Revenir en arriÃ¨re :

helm rollback my-release 1

ğŸ‘‰ Rollback fiable et instantanÃ©


---

ğŸŒ 8. Helm et les environnements

Approche recommandÃ©e :

values-dev.yaml
values-staging.yaml
values-prod.yaml

DÃ©ploiement :

helm install my-app ./my-chart -f values-prod.yaml


---

ğŸ” 9. Helm et la sÃ©curitÃ©

Bonnes pratiques :

RÃ¨gle	Pourquoi

Pas de secrets en clair	SÃ©curitÃ©
Utiliser Secret Kubernetes	IntÃ©gration native
Scanner les charts	VulnÃ©rabilitÃ©s
Charts versionnÃ©s	TraÃ§abilitÃ©



---

ğŸ§  10. Helm en production

Helm est utilisÃ© pour :

Applications internes

Middleware (Ingress, monitoringâ€¦)

DÃ©ploiements standards


Mais en prod moderne : ğŸ‘‰ Helm est souvent combinÃ© avec GitOps


---

ğŸ“Œ RÃ©sumÃ© du chapitre

Ã‰lÃ©ment	RÃ´le

Helm	Gestionnaire de packages
Chart	Application packagÃ©e
values.yaml	Configuration
Template	YAML dynamique
Rollback	SÃ©curitÃ© opÃ©rationnelle



---

ğŸ“ Ã€ retenir

> Helm transforme Kubernetes
dâ€™un ensemble de YAML statiques
en une plateforme dÃ©ployable, versionnÃ©e et maintenable.




---

ğŸ”œ Chapitre suivant

ğŸš¦ StratÃ©gies de dÃ©ploiement avancÃ©es
â¡ï¸ Rolling update
â¡ï¸ Blue/Green
â¡ï¸ Canary
